<!DOCTYPE html><html lang=en> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=author content=sunflowerno0b><link href=https://sunflowerno0b.github.io/Things-Learned/Securedrop/ rel=canonical><link rel="shortcut icon" href=../img/favicon.ico><title>Securedrop - Things Learned</title><link href=../css/bootstrap.min.css rel=stylesheet><link href=../css/font-awesome.min.css rel=stylesheet><link href=../css/base.css rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atelier-forest-light.min.css><link href=../stylesheets/extra.css rel=stylesheet><script src=../js/jquery-1.10.2.min.js defer></script><script src=../js/bootstrap.min.js defer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js></script><script>hljs.initHighlightingOnLoad();</script><style>
        .git-revision-date-localized-plugin-iso_date { display: none }
        @media print {
           .git-revision-date-localized-plugin-iso_date { display: inline } 
           .git-revision-date-localized-plugin-timeago { display: none } 
        }
        </style></head> <body> <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary"> <div class=container> <a class=navbar-brand href=..>Things Learned</a> <!-- Expander button --> <button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-collapse> <span class=navbar-toggler-icon></span> </button> <!-- Expanded navigation --> <div id=navbar-collapse class="navbar-collapse collapse"> <!-- Main navigation --> <ul class="nav navbar-nav"> <li class=navitem> <a href=.. class=nav-link>Introduction</a> </li> <li class=navitem> <a href=../Markdown%20Syntax/ class=nav-link>Markdown Syntax</a> </li> <li class="navitem active"> <a href=./ class=nav-link>Securedrop</a> </li> <li class=dropdown> <a href=# class="nav-link dropdown-toggle" data-toggle=dropdown>Systems <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../Web%20Services/ class=dropdown-item>Web Services</a> </li> <li> <a href=../VS%20Code%20Install/ class=dropdown-item>VS Code</a> </li> <li> <a href=../Ansible%20Vault/ class=dropdown-item>Ansible Vault</a> </li> </ul> </li> <li class=navitem> <a href=../Resources/ class=nav-link>Resources</a> </li> </ul> <ul class="nav navbar-nav ml-auto"> <li class=nav-item> <a href=# class=nav-link data-toggle=modal data-target=#mkdocs_search_modal> <i class="fa fa-search"></i> Search </a> </li> <li class=nav-item> <a rel=prev href=../Markdown%20Syntax/ class=nav-link> <i class="fa fa-arrow-left"></i> Previous </a> </li> <li class=nav-item> <a rel=next href=../Web%20Services/ class=nav-link> Next <i class="fa fa-arrow-right"></i> </a> </li> <li class=nav-item> <a href=https://github.com/sunflowerno0b/Things-Learned/edit/master/docs/Securedrop.md class=nav-link>Edit on sunflowerno0b/Things-Learned</a> </li> </ul> </div> </div> </div> <div class=container> <div class=row> <div class=col-md-3><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role=complementary> <div class=navbar-header> <button type=button class="navbar-toggler collapsed" data-toggle=collapse data-target=#toc-collapse title="Table of Contents"> <span class="fa fa-angle-down"></span> </button> </div> <div id=toc-collapse class="navbar-collapse collapse card bg-secondary"> <ul class="nav flex-column"> </ul> </div> </div></div> <div class=col-md-9 role=main> <h1>SecureDrop</h1> <p>At my current role, I am a SecureDrop (SD) admin. It was not known to me how intense this role would be and all the terminal jargon I would have to know. Because of this, I will also store here and share tips and tricks that I have learned throughout my 3 years working with the tool. </p> <h2>What is it?</h2> <p>SecureDrop is an open source whistle blower submission system that media organizations and NGOs can install to securely accept documents from anonymous sources. It was originally created by the late Aaron Swartz and is now managed by Freedom of the Press Foundation. SecureDrop is available in 20 languages. More info can be found <a href=https://securedrop.org/ >here</a>.</p> <p>For my day-to-day I check SD for anonymous submissions of potential news story leads. </p> <h2>How does it work?</h2> <h3>Tails</h3> <p>I will be limiting this section for security reasons. SecureDrop works with the The Amnesic Incognito Live System (tails). It’s an OS system, similar to Linux, MacOS &amp; windows. The beauty of it is that it boots from a USB, and wipes itself clean after each use. It works only with TOR browsers. Arguably considered the most way to secure yourself on the internet. Check out more on tails <a href=https://tails.boum.org/index.en.html>here</a>. Tails works in conjunction with tor browsers that use .onion websites. Info on tor <a href=https://www.torproject.org/ >here</a></p> <h3>The Computers</h3> <p>There is an <strong>Admin Station</strong> &amp; there is a <strong>Secure Viewing Station (svs)</strong>. The admin station has access to the internet, where I use tor to access ".onion" sites. I pull attachments from said sites, load them to an encrypted USB. This USB is then taken to the SVS. Both machines utilize tails exclusively. </p> <p>The SVS is not connected to the internet. With the encrypted USB drive and another tails USB, the system boots. From there the contents of submissions and such are able to be viewed. The backbone of security for viewing submissions relies on long pass-phrases &amp; PGP, check out the PGP documentation in my git for more on that. </p> <h1>Maintenance of SD</h1> <p>Being a sysadmin for SD requires understanding of the command line, SSH with sever(s), and the role of each USB. FPF attempts to make it easy with GUI options but I can attest that this does not always work.</p> <h2>Command line</h2> <p>When updating and you don’t see it working with the GUI</p> <h2>V2 &amp; V3 Upgrade</h2> <p>Recently it was announced that the support for V2 onions would cease. Earlier I mentioned onion (tor browsers). Check back there in case you need a refresher. This leaves V2 running instances vulnerable, eliminate the vulnerability by switching to V3. </p> <h2>Steps</h2> <h3>Verify ssh config files for Mon and App (your servers)</h3> <p>Every secure drop instance will have the Admin USB and the Journalist USB, for any major configurations to SD, it will run from the admin USB only. </p> <p>First, open the terminal navigate to the SD directory- enter <code>cd ~/Persistent/securedrop</code> then verify that in servers (app &amp; mon) have the files for ssh, they are titled <code>app-ssh-ths</code> &amp; <code>mon-ssh-ths</code>. If they are there, excellent. If not, contact FPF support <strong>ASAP</strong>.</p> <h3>Check your git status</h3> <p>Within the same <code>cd ~/Persistent/securedrop</code>, enter <code>git status</code>. This will have the output of where the <code>head detached at x.x.x</code>. You want to make sure that its at the latest version. </p> <h3>Verify what servers app &amp; mon are connected to</h3> <p>Again, within the same directory type this command <code>cat ~/Persistent/securedrop/install_files/ansible-base/app-source-ths</code>. After this command is run there is a secret URL that should be displayed here. When I say secret its a URL made of tons of letters- this is <strong>not</strong> to be shared. In my case there was not a secret URL it was a plain IP address not good. What to do? Reconfigure the servers.</p> <p>Run <code>ssh -vvv app</code> <code>ssh -vvv mon</code>. This will produce a verbose output of the debug as its attempting to connect with the servers. Note that this point for me nothing was really showing beyond it not connecting. After that you have to reconfigure your admin USB stick. </p> <p>To reconfigure type <code>./securedrop-admin sdconfig</code>. As a reminder this is all within the <code>~Persistent/securedrop</code> directory. The sdconfig gets all the configurations ready to send to the servers. It will provide with an interactive CL prompt where you will go through a series of questions. In this section, we also pay close attention to the questions on enabling or disabling V2, V3. Be sure to click yes for V3. Keeping V2 on is optional, but less secure. After that completes, you can type <code>cat ~/.ssh/config</code>. This will show the ssh configuration file, and we <strong><em>should</em></strong> see the private onion URL rather than the plain IP address we were seeing earlier. </p> <h3>Test ssh Connection</h3> <p>To test your ssh connection to the severs enter <code>ssh app</code> &amp; <code>ssh mon</code>. If your terminal switches to app@XXXX then you've successfully SSH'd. </p> <h3>Back up the admin stick</h3> <p>It's good practice to create back ups of the admin stick/ journalist stick(s) in case something goes wrong during an upgrade you can always roll back. To do that enter <code>./securedrop-admin backup</code>. This command creates a tarball for the current settings. This will take a while, do not fret. </p> <h3>Pushing the Configurations to the Servers</h3> <p>So everything that was done so far was only done locally within the tails/admin USB. The severs have no idea, and they are still operating under the old configurations. To make sure the servers have the correct configurations installed you should do the following. </p> <p>Run <code>./securedrop-admin sdconfig</code> &larr; applies the changes locally once more Run <code>./securedrop-admin install</code> &larr; this will send the configurations made in the step above to the servers. </p> <h3>End</h3> <p>I would ensure that you still have ssh capabilities. See above. And finally I would make sure that you have access to both of your instances. If you enabled V3, there should be a new link you should take note of which will appear as you access the source and journalists interface on the tor browser!</p></div> </div> </div> <footer class=col-md-12> <hr> <p>Documentation built with <a href=https://www.mkdocs.org/ >MkDocs</a>.</p> </footer> <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script> <script src=../js/base.js defer></script> <script src=../search/main.js defer></script> <div class=modal id=mkdocs_search_modal tabindex=-1 role=dialog aria-labelledby=searchModalLabel aria-hidden=true> <div class="modal-dialog modal-lg"> <div class=modal-content> <div class=modal-header> <h4 class=modal-title id=searchModalLabel>Search</h4> <button type=button class=close data-dismiss=modal><span aria-hidden=true>&times;</span><span class=sr-only>Close</span></button> </div> <div class=modal-body> <p> From here you can search these documents. Enter your search terms below. </p> <form> <div class=form-group> <input type=search class=form-control placeholder=Search... id=mkdocs-search-query title="Type search term here"> </div> </form> <div id=mkdocs-search-results></div> </div> <div class=modal-footer> </div> </div> </div> </div><div class=modal id=mkdocs_keyboard_modal tabindex=-1 role=dialog aria-labelledby=keyboardModalLabel aria-hidden=true> <div class=modal-dialog> <div class=modal-content> <div class=modal-header> <h4 class=modal-title id=keyboardModalLabel>Keyboard Shortcuts</h4> <button type=button class=close data-dismiss=modal><span aria-hidden=true>&times;</span><span class=sr-only>Close</span></button> </div> <div class=modal-body> <table class=table> <thead> <tr> <th style="width: 20%;">Keys</th> <th>Action</th> </tr> </thead> <tbody> <tr> <td class="help shortcut"><kbd>?</kbd></td> <td>Open this help</td> </tr> <tr> <td class="next shortcut"><kbd>n</kbd></td> <td>Next page</td> </tr> <tr> <td class="prev shortcut"><kbd>p</kbd></td> <td>Previous page</td> </tr> <tr> <td class="search shortcut"><kbd>s</kbd></td> <td>Search</td> </tr> </tbody> </table> </div> <div class=modal-footer> </div> </div> </div> </div> <script src=https://cdnjs.cloudflare.com/ajax/libs/timeago.js/4.0.0-beta.2/timeago.min.js></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/timeago.js/4.0.0-beta.2/timeago.locales.min.js></script> <script>
          if (
            typeof app !== "undefined" && 
            typeof app.document$ !== "undefined"
            ) {
            app.document$.subscribe(function() {
                var nodes = document.querySelectorAll('.timeago');
                var locale = nodes[0].getAttribute('locale');
                timeago.render(nodes, locale);
            })
         } else {
             var nodes = document.querySelectorAll('.timeago');
             var locale = nodes[0].getAttribute('locale');
             timeago.render(nodes, locale);
         }
          </script> </body> </html> 